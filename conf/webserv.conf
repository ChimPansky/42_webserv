
use poll;

error_log  /log/error.log  debug;

http {

    client_max_body_size 1 MB;

    error_page 404 www/error_pages/404.html;
    error_page 501 www/error_pages/501.html;
    autoindex off;

    keepalive_timeout 65;
    index     docs/webserv_eval.html;

    server {

        listen  8082;
        # listen  9091;
        # listen  127.0.0.1:5500;
        server_name serv1;

        access_log /log/server1.log info;

        location = /docs/ {
            alias  /docs/;
            limit_except GET POST;
        }

        location /error_pages/ {
            alias  /docs/;
            limit_except GET POST;
            autoindex on;
        }

        location /cgi-bin/ {

            alias   /www/cgi_test/cgi-bin;
            cgi_extension .py;
            limit_except GET POST;
        }

        location /static/ {
            alias    /www/random_test;
        }

        location / {
            index index.html;
            autoindex on;
            alias  /www/cgi_test/;
            limit_except GET POST;
        }

        location /default_css/ {
            alias /www/autoindex/css/;
            limit_except GET;
        }

        location /autoindex {
            autoindex on;
            alias  /www/autoindex_test;
            limit_except GET POST;
        }

        location /files {
            autoindex on;
            alias /www/files/;
            limit_except GET POST;
            upload_store /path/to/dir;
        }

        location /fileupload/ {
            upload_store /upload/;
            #upload_pass /upload;
            #upload_set_form_field $upload_field_name.name "$upload_file_name";
            #upload_set_form_field $upload_field_name.content_type "$upload_content_type";
            #upload_set_form_field $upload_field_name.path "$upload_tmp_path";
            #upload_aggregate_form_field $upload_field_name.size "$upload_file_size";
            #upload_pass_form_field "^submit$";
            #upload_cleanup 400 404 499 500-505;
            autoindex on;
            limit_except GET POST DELETE;
            alias /www/upload/;
        }
    }


    server {

        listen  8082;
        server_name serv2 *.example.com;

        access_log /log/server2.log info;

        location /conf/ {

            return 301 /error_pages/404.html;
        }


        # localhost:8080/test1/cgi-bin/scrip.py
        location /test1/cgi-bin/ {

            alias /cgi-bin;
            cgi_path /cgi-bin;
            cgi_extension .php .py;
            limit_except GET POST;
        }
    }

}
